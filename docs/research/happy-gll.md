# Happy-GLL: modular, reusable and complete top-down parsers for parameterized nonterminals

**論文**: https://arxiv.org/abs/2303.08044  
**著者**: L. Thomas van Binsbergen, Damian Frolich  
**発表**: 2023年3月

## 概要

Happy-GLLは、Haskellの有名なパーサージェネレータであるHappyに新しいGLL（Generalized LL）バックエンドを追加したもの。この拡張により、モジュラーで再利用可能、かつ完全な（全ての導出を発見できる）トップダウンパーサーの生成が可能になった。

## 主な貢献

### 1. パラメータ化された非終端記号のサポート
- 非終端記号をパラメータ化し、文法を跨いで抽象化可能に
- 高階関数のようなパーサーコンビネータを生成

### 2. モジュラーで再利用可能なパーサー
- パーサーを独立したモジュールとして定義
- 異なる文法間でパーサーコンポーネントを共有可能

### 3. 完全なパーシング
- 文脈自由文法の全クラスに対応
- 曖昧な文法でも全ての可能な導出を発見
- 線形時間でパーサーを生成

## 技術的詳細

### GLL（Generalized LL）アルゴリズム
- LL解析の拡張版で、左再帰を含む任意の文脈自由文法を扱える
- Graph Structured Stack（GSS）を使用して複数の解析パスを管理
- Shared Packed Parse Forest（SPPF）で全ての導出を効率的に表現

### パラメータ化の仕組み
```haskell
-- 例：パラメータ化された非終端記号
paramNT :: (a -> Parser b) -> Parser c
```
- 非終端記号が他のパーサーを引数として受け取れる
- 文法の抽象化とコード再利用が可能

## Vibe言語への応用可能性

### 利点
1. **モジュラー性**: Vibeの名前空間システムと親和性が高い
2. **完全性**: 曖昧性のあるエラー回復パーシングに有用
3. **パラメータ化**: エフェクトシステムのような複雑な構文に対応可能

### 課題
1. **パフォーマンス**: 完全性とのトレードオフ
2. **複雑性**: GLLアルゴリズムの実装は単純なLL/LRより複雑
3. **Rust実装**: HappyはHaskell向けなので、Rustでの再実装が必要

### 具体的な応用案
- エラー回復機能を持つパーサーの実装
- インクリメンタルパーシングへの拡張
- 構文拡張メカニズムの実装（マクロシステム）